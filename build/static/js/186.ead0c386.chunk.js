"use strict";(self.webpackChunkquero_paz=self.webpackChunkquero_paz||[]).push([[186],{3186:(e,a,t)=>{t.r(a),t.d(a,{default:()=>I});var s=t(5043),r=t(1404);const n={async analyzeFrequencyPatterns(){const e=(await r.A.getSilencedCalls()).map((e=>(e.includes(" - ")?e.split(" - "):[e,""])[0].trim())),a={};e.forEach((e=>{a[e]=(a[e]||0)+1}));return Object.keys(a).filter((e=>a[e]>=3)).map((e=>({phoneNumber:e,frequency:a[e],confidence:Math.min(a[e]/3*100,100),suggestedAction:"block"})))},async analyzeTimePatterns(){const e=await r.A.getSilencedCalls(),a=[],t=Array(24).fill(0);e.forEach((e=>{const a=e.match(/\xe0s (\d{2}):(\d{2})/);if(a){const e=parseInt(a[1],10);t[e]++}}));for(let s=0;s<24;s++)t[s]>=3&&a.push({hour:s,frequency:t[s],confidence:Math.min(t[s]/3*100,100),suggestedAction:"create_time_rule"});return a},async analyzePrefixPatterns(){const e=await r.A.getSilencedCalls(),a={};e.forEach((e=>{const t=(e.includes(" - ")?e.split(" - "):[e,""])[0].trim().replace(/\D/g,"");if(t.length>=2){const e=t.substring(0,2);if(a[e]=(a[e]||0)+1,t.length>=3){const e=t.substring(0,3);a[e]=(a[e]||0)+1}}}));return Object.keys(a).filter((e=>a[e]>=3)).map((e=>({prefix:e,length:e.length,frequency:a[e],confidence:Math.min(a[e]/3*100,100),suggestedAction:"create_prefix_rule"}))).sort(((e,a)=>a.frequency-e.frequency))},async generateBlockingRecommendations(){const[e,a,t]=await Promise.all([this.analyzeFrequencyPatterns(),this.analyzeTimePatterns(),this.analyzePrefixPatterns()]);return[...e.map((e=>({type:"number",value:e.phoneNumber,reason:"Ligou ".concat(e.frequency," vezes"),confidence:e.confidence,action:"block_number"}))),...a.map((e=>({type:"time",value:"".concat(e.hour,":00"),reason:"".concat(e.frequency," chamadas indesejadas neste hor\xe1rio"),confidence:e.confidence,action:"block_time"}))),...t.filter((e=>e.confidence>70)).map((e=>({type:"prefix",value:e.prefix,reason:"".concat(e.frequency," chamadas com este prefixo"),confidence:e.confidence,action:"block_prefix"})))].sort(((e,a)=>a.confidence-e.confidence))}};var o=t(579);const i=e=>{let{onApplyRecommendation:a}=e;const[t,r]=(0,s.useState)(!0),[i,c]=(0,s.useState)([]),[l,d]=(0,s.useState)(!1),u=(0,s.useCallback)((async()=>{r(!0);try{const e=await n.generateBlockingRecommendations();c(e)}catch(e){console.error("Erro ao carregar recomenda\xe7\xf5es:",e)}finally{r(!1)}}),[]);(0,s.useEffect)((()=>{u()}),[u]);return(0,o.jsxs)("div",{className:"bg-white rounded-paz shadow-paz overflow-hidden transition-all",children:[(0,o.jsxs)("div",{className:"bg-paz-blue-50 p-4 flex justify-between items-center cursor-pointer border-b border-paz-blue-100",onClick:()=>d(!l),children:[(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("div",{className:"text-paz-blue-600 p-2 rounded-full bg-paz-blue-100 mr-3",children:(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:"font-semibold text-lg text-paz-blue-800",children:"An\xe1lise Inteligente"}),(0,o.jsx)("p",{className:"text-sm text-paz-blue-600",children:t?"Analisando padr\xf5es...":"".concat(i.length," recomenda\xe7\xf5es encontradas")})]})]}),(0,o.jsx)("div",{className:"text-paz-blue-600",children:(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 transition-transform ".concat(l?"rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),l&&(0,o.jsx)("div",{className:"p-4",children:t?(0,o.jsx)("div",{className:"flex justify-center py-8",children:(0,o.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-paz-blue-600"})}):i.length>0?(0,o.jsxs)("div",{className:"space-y-3",children:[(0,o.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Nossa an\xe1lise identificou padr\xf5es em chamadas bloqueadas e sugere as seguintes a\xe7\xf5es:"}),i.slice(0,5).map(((e,t)=>{const s=(r=e.confidence)>=80?{text:"Alta",class:"bg-paz-green-100 text-paz-green-800"}:r>=50?{text:"M\xe9dia",class:"bg-yellow-100 text-yellow-800"}:{text:"Baixa",class:"bg-gray-100 text-gray-800"};var r;const n=(e=>{switch(e){case"number":return{text:"N\xfamero",icon:"\ud83d\udcf1"};case"time":return{text:"Hor\xe1rio",icon:"\ud83d\udd52"};case"prefix":return{text:"Prefixo",icon:"\ud83d\udd22"};default:return{text:"Outro",icon:"\ud83d\udccb"}}})(e.type);return(0,o.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-200",children:[(0,o.jsxs)("div",{className:"flex justify-between items-start",children:[(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("span",{className:"text-xl mr-2",children:n.icon}),(0,o.jsxs)("div",{children:[(0,o.jsx)("h4",{className:"font-medium",children:e.value}),(0,o.jsx)("p",{className:"text-sm text-gray-600",children:e.reason})]})]}),(0,o.jsx)("span",{className:"text-xs px-2 py-1 rounded-full ".concat(s.class),children:s.text})]}),(0,o.jsx)("div",{className:"mt-3 flex justify-end",children:(0,o.jsx)("button",{onClick:()=>{return t=e,void(a&&a(t));var t},className:"px-3 py-1 bg-paz-blue-600 hover:bg-paz-blue-700 text-white text-sm rounded transition",children:"Aplicar"})})]},t)})),i.length>5&&(0,o.jsx)("div",{className:"text-center pt-2",children:(0,o.jsxs)("button",{className:"text-sm text-paz-blue-600 hover:text-paz-blue-800",children:["Ver mais ",i.length-5," recomenda\xe7\xf5es"]})})]}):(0,o.jsxs)("div",{className:"text-center py-6",children:[(0,o.jsx)("p",{className:"text-gray-600",children:"Nenhum padr\xe3o significativo identificado ainda. Continue bloqueando chamadas para melhorar as recomenda\xe7\xf5es."}),(0,o.jsx)("button",{onClick:u,className:"mt-4 px-4 py-2 bg-paz-blue-100 text-paz-blue-700 rounded-lg hover:bg-paz-blue-200 transition",children:"Atualizar an\xe1lise"})]})})]})};var c=t(9379);const l="time_based",d="whitelist",u="duration",m="prefix",p="active",h="inactive",x="auto",g={getRules:async()=>await r.A.getItem("smart_rules")||[],async addRule(e){const a=await this.getRules(),t=(0,c.A)((0,c.A)({},e),{},{id:Date.now().toString(),createdAt:(new Date).toISOString(),status:e.status||p});return await r.A.setItem("smart_rules",[...a,t]),t},async updateRule(e,a){const t=await this.getRules(),s=t.findIndex((a=>a.id===e));return-1!==s&&(t[s]=(0,c.A)((0,c.A)((0,c.A)({},t[s]),a),{},{updatedAt:(new Date).toISOString()}),await r.A.setItem("smart_rules",t),!0)},async deleteRule(e){const a=await this.getRules(),t=a.filter((a=>a.id!==e));return t.length!==a.length&&(await r.A.setItem("smart_rules",t),!0)},async createTimeRule(e,a,t,s){return this.addRule({type:l,name:s||"Bloqueio das ".concat(e,"h \xe0s ").concat(a,"h"),config:{startHour:e,endHour:a,daysOfWeek:t||[0,1,2,3,4,5,6]},action:"block",status:p})},async createWhitelistRule(e,a){return this.addRule({type:d,name:a||"Lista de contatos priorit\xe1rios",config:{phoneNumbers:e||[]},action:"allow",status:p})},async createDurationRule(e,a,t){return this.addRule({type:u,name:t||"Bloqueio de chamadas curtas repetitivas",config:{maxDuration:e||5,minFrequency:a||3,timeWindow:36e5},action:"block",status:p})},async evaluateCall(e){const a=(await this.getRules()).filter((e=>e.status===p||e.status===x)),t=a.filter((e=>e.type===d));for(const s of t)if(s.config.phoneNumbers.includes(e.phoneNumber))return{action:"allow",reason:"Contato priorit\xe1rio",rule:s};for(const s of a)if(s.type!==d){if(s.type===l){const e=new Date,a=e.getHours(),t=e.getDay();if(s.config.daysOfWeek.includes(t))if(s.config.startHour<=s.config.endHour){if(a>=s.config.startHour&&a<s.config.endHour)return{action:s.action,reason:"Hor\xe1rio restrito: ".concat(s.name),rule:s}}else if(a>=s.config.startHour||a<s.config.endHour)return{action:s.action,reason:"Hor\xe1rio restrito: ".concat(s.name),rule:s}}if(s.type===m&&e.phoneNumber&&e.phoneNumber.startsWith(s.config.prefix))return{action:s.action,reason:"Prefixo bloqueado: ".concat(s.name),rule:s};if(s.type===u){const a=(await this.getRecentCallsByNumber(e.phoneNumber,s.config.timeWindow)).filter((e=>e.duration<=s.config.maxDuration));if(a.length>=s.config.minFrequency)return{action:s.action,reason:"Padr\xe3o detectado: ".concat(a.length," chamadas curtas"),rule:s}}}return{action:"default",reason:"Nenhuma regra aplic\xe1vel"}},async getRecentCallsByNumber(e,a){const t=Date.now();return(await r.A.getCallHistory()).filter((s=>{if(s.phoneNumber!==e)return!1;const r=new Date(s.time).getTime();return t-r<=a}))},generateRuleRecommendations:async()=>[{type:l,name:"Modo Noturno",description:"Bloquear chamadas durante a noite",config:{startHour:22,endHour:7,daysOfWeek:[0,1,2,3,4,5,6]}},{type:u,name:"Anti-Telemarketing",description:"Bloquear n\xfameros que fazem m\xfaltiplas chamadas curtas",config:{maxDuration:5,minFrequency:2,timeWindow:36e5}}]},f=()=>{const[e,a]=(0,s.useState)([]),[t,r]=(0,s.useState)(!0),[n,i]=(0,s.useState)(!1),[c,x]=(0,s.useState)(null),f=(0,s.useCallback)((async()=>{r(!0);try{const e=await g.getRules();a(e)}catch(e){console.error("Erro ao carregar regras:",e)}finally{r(!1)}}),[]);(0,s.useEffect)((()=>{f()}),[f]);const b=e=>{switch(e){case l:return(0,o.jsx)("span",{className:"text-lg",children:"\ud83d\udd52"});case d:return(0,o.jsx)("span",{className:"text-lg",children:"\u2705"});case u:return(0,o.jsx)("span",{className:"text-lg",children:"\u23f1\ufe0f"});case m:return(0,o.jsx)("span",{className:"text-lg",children:"\ud83d\udcde"});default:return(0,o.jsx)("span",{className:"text-lg",children:"\ud83d\udee1\ufe0f"})}},y=e=>{var a;switch(e.type){case l:return"".concat(e.config.startHour,"h \xe0s ").concat(e.config.endHour,"h");case d:const t=(null===(a=e.config.phoneNumbers)||void 0===a?void 0:a.length)||0;return"".concat(t," contatos permitidos");case u:return"Chamadas < ".concat(e.config.maxDuration,"s");case m:return"Prefixo: ".concat(e.config.prefix);default:return""}};return(0,o.jsxs)("div",{className:"bg-white rounded-paz shadow-paz overflow-hidden transition-all mb-4",children:[(0,o.jsxs)("div",{className:"bg-paz-blue-50 p-4 flex justify-between items-center cursor-pointer border-b border-paz-blue-100",onClick:()=>i(!n),children:[(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("div",{className:"text-paz-blue-600 p-2 rounded-full bg-paz-blue-100 mr-3",children:(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:"font-semibold text-lg text-paz-blue-800",children:"Regras Inteligentes"}),(0,o.jsxs)("p",{className:"text-sm text-paz-blue-600",children:[e.filter((e=>e.status===p)).length," regras ativas"]})]})]}),(0,o.jsx)("div",{className:"text-paz-blue-600",children:(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 transition-transform ".concat(n?"rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),n&&(0,o.jsx)("div",{className:"p-4",children:t?(0,o.jsx)("div",{className:"flex justify-center py-8",children:(0,o.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-paz-blue-600"})}):(0,o.jsxs)("div",{children:[e.length>0?(0,o.jsx)("div",{className:"space-y-3 mb-6",children:e.map((e=>(0,o.jsxs)("div",{className:"p-3 rounded-lg border ".concat(e.status===p?"border-paz-blue-500 bg-paz-blue-50":"border-gray-200 bg-gray-50"),children:[(0,o.jsxs)("div",{className:"flex justify-between items-start",children:[(0,o.jsxs)("div",{className:"flex items-center",children:[b(e.type),(0,o.jsxs)("div",{className:"ml-2",children:[(0,o.jsx)("h4",{className:"font-medium",children:e.name}),(0,o.jsx)("p",{className:"text-sm text-gray-600",children:y(e)})]})]}),(0,o.jsxs)("div",{className:"relative inline-block w-10 align-middle select-none",children:[(0,o.jsx)("input",{type:"checkbox",name:"toggle-".concat(e.id),id:"toggle-".concat(e.id),className:"sr-only peer",checked:e.status===p,onChange:()=>(async(e,a)=>{try{const t=a===p?h:p;await g.updateRule(e,{status:t}),f()}catch(t){console.error("Erro ao atualizar regra:",t)}})(e.id,e.status)}),(0,o.jsx)("label",{htmlFor:"toggle-".concat(e.id),className:"block h-6 overflow-hidden rounded-full bg-gray-300 cursor-pointer peer-checked:bg-paz-blue-600",children:(0,o.jsx)("span",{className:"absolute transform transition-transform duration-200 ease-in-out left-1 top-1 bg-white rounded-full h-4 w-4 peer-checked:translate-x-4"})})]})]}),(0,o.jsxs)("div",{className:"mt-3 flex justify-end space-x-2",children:[(0,o.jsx)("button",{onClick:()=>x(e),className:"px-3 py-1 bg-gray-200 hover:bg-gray-300 text-gray-800 text-sm rounded transition",children:"Editar"}),(0,o.jsx)("button",{onClick:()=>(async e=>{try{await g.deleteRule(e),f()}catch(a){console.error("Erro ao excluir regra:",a)}})(e.id),className:"px-3 py-1 bg-paz-red-100 hover:bg-paz-red-200 text-paz-red-800 text-sm rounded transition",children:"Excluir"})]})]},e.id)))}):(0,o.jsx)("div",{className:"text-center py-6 mb-6",children:(0,o.jsx)("p",{className:"text-gray-600",children:"Nenhuma regra inteligente configurada. Crie uma regra para come\xe7ar a personalizar o bloqueio."})}),(0,o.jsxs)("div",{className:"mt-6 border-t border-gray-200 pt-4",children:[(0,o.jsx)("h4",{className:"font-medium text-paz-blue-800 mb-3",children:"Adicionar Regra"}),(0,o.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,o.jsxs)("button",{onClick:async()=>{try{await g.createTimeRule(22,7,[0,1,2,3,4,5,6],"Sil\xeancio noturno"),f()}catch(e){console.error("Erro ao criar regra de hor\xe1rio:",e)}},className:"flex flex-col items-center justify-center p-3 bg-indigo-50 hover:bg-indigo-100 text-indigo-800 rounded transition",children:[(0,o.jsx)("span",{className:"text-xl mb-1",children:"\ud83d\udd52"}),(0,o.jsx)("span",{className:"text-sm",children:"Hor\xe1rio"})]}),(0,o.jsxs)("button",{onClick:async()=>{try{await g.createWhitelistRule([],"Contatos priorit\xe1rios"),f()}catch(e){console.error("Erro ao criar regra de lista branca:",e)}},className:"flex flex-col items-center justify-center p-3 bg-green-50 hover:bg-green-100 text-green-800 rounded transition",children:[(0,o.jsx)("span",{className:"text-xl mb-1",children:"\u2705"}),(0,o.jsx)("span",{className:"text-sm",children:"Lista Branca"})]}),(0,o.jsxs)("button",{onClick:async()=>{try{await g.createDurationRule(5,3,"Bloqueio anti-telemarketing"),f()}catch(e){console.error("Erro ao criar regra de dura\xe7\xe3o:",e)}},className:"flex flex-col items-center justify-center p-3 bg-amber-50 hover:bg-amber-100 text-amber-800 rounded transition",children:[(0,o.jsx)("span",{className:"text-xl mb-1",children:"\u23f1\ufe0f"}),(0,o.jsx)("span",{className:"text-sm",children:"Dura\xe7\xe3o"})]})]})]})]})})]})},b="sleep",y="work",j="vacation",v="meeting",N="active",w="inactive",k="scheduled",z={getProfiles:async()=>await r.A.getItem("block_profiles")||[],async getActiveProfile(){return(await this.getProfiles()).find((e=>e.status===N))||null},async createProfile(e){const a=await this.getProfiles(),t=(0,c.A)((0,c.A)({},e),{},{id:Date.now().toString(),createdAt:(new Date).toISOString(),status:e.status||w,ruleIds:e.ruleIds||[]});return await r.A.setItem("block_profiles",[...a,t]),t},async updateProfile(e,a){const t=await this.getProfiles(),s=t.findIndex((a=>a.id===e));return-1!==s&&(t[s]=(0,c.A)((0,c.A)((0,c.A)({},t[s]),a),{},{updatedAt:(new Date).toISOString()}),await r.A.setItem("block_profiles",t),!0)},async deleteProfile(e){const a=await this.getProfiles(),t=a.filter((a=>a.id!==e));return t.length!==a.length&&(await r.A.setItem("block_profiles",t),!0)},async activateProfile(e){const a=(await this.getProfiles()).map((a=>(0,c.A)((0,c.A)({},a),{},{status:a.id===e?N:w})));await r.A.setItem("block_profiles",a);const t=a.find((a=>a.id===e));if(t&&t.ruleIds)for(const s of t.ruleIds)await g.updateRule(s,{status:p});return!0},async deactivateAllProfiles(){const e=(await this.getProfiles()).map((e=>(0,c.A)((0,c.A)({},e),{},{status:w})));return await r.A.setItem("block_profiles",e),!0},async createSleepProfile(){const e=await g.createTimeRule(22,7,[0,1,2,3,4,5,6],"Hor\xe1rio de sono"),a=await g.createWhitelistRule([],"Contatos de emerg\xeancia");return this.createProfile({name:"Modo Sono",type:b,description:"Bloqueia todas as chamadas durante a noite, exceto contatos de emerg\xeancia",icon:"moon",color:"#1e40af",ruleIds:[e.id,a.id],status:w})},async createWorkProfile(){const e=await g.createTimeRule(8,18,[1,2,3,4,5],"Hor\xe1rio de trabalho"),a=await g.createWhitelistRule([],"Contatos de trabalho");return this.createProfile({name:"Modo Trabalho",type:y,description:"Filtra chamadas durante o hor\xe1rio de trabalho, permitindo apenas contatos importantes",icon:"briefcase",color:"#15803d",ruleIds:[e.id,a.id],status:w})},async createVacationProfile(){const e=await g.createWhitelistRule([],"Fam\xedlia e amigos pr\xf3ximos"),a=await g.createDurationRule(5,2,"Anti-spam f\xe9rias");return this.createProfile({name:"Modo F\xe9rias",type:j,description:"Bloqueio rigoroso de chamadas, permitindo apenas contatos mais pr\xf3ximos",icon:"beach",color:"#b91c1c",ruleIds:[e.id,a.id],status:w})},async createMeetingProfile(){const e=await g.createWhitelistRule([],"Contatos cr\xedticos");return this.createProfile({name:"Modo Reuni\xe3o",type:v,description:"Bloqueio tempor\xe1rio para reuni\xf5es importantes",icon:"users",color:"#7f1d1d",ruleIds:[e.id],status:w,duration:60})},async scheduleProfile(e,a,t){const s=await this.getProfiles(),n=s.findIndex((a=>a.id===e));return-1!==n&&(s[n]=(0,c.A)((0,c.A)({},s[n]),{},{status:k,schedule:{startDate:a.toISOString(),endDate:t.toISOString(),active:!0},updatedAt:(new Date).toISOString()}),await r.A.setItem("block_profiles",s),!0)},async processScheduledProfiles(){const e=await this.getProfiles(),a=new Date;let t=!1;for(let s=0;s<e.length;s++){const r=e[s];if(r.status===k&&r.schedule&&r.schedule.active){const n=new Date(r.schedule.startDate),o=new Date(r.schedule.endDate);if(a>=n&&a<o&&r.status!==N){if(e[s]=(0,c.A)((0,c.A)({},r),{},{status:N}),t=!0,r.ruleIds)for(const e of r.ruleIds)await g.updateRule(e,{status:p})}else if(a>=o&&r.status!==w&&(e[s]=(0,c.A)((0,c.A)({},r),{},{status:w,schedule:(0,c.A)((0,c.A)({},r.schedule),{},{active:!1})}),t=!0,r.ruleIds))for(const e of r.ruleIds)await g.updateRule(e,{status:h})}}t&&await r.A.setItem("block_profiles",e)}},A=()=>{const[e,a]=(0,s.useState)([]),[t,r]=(0,s.useState)(!0),[n,i]=(0,s.useState)(!1),[c,l]=(0,s.useState)(null),d=(0,s.useCallback)((async()=>{r(!0);try{const e=await z.getProfiles();a(e);const t=e.find((e=>e.status===N));l(t||null)}catch(e){console.error("Erro ao carregar perfis:",e)}finally{r(!1)}}),[]);(0,s.useEffect)((()=>{d()}),[d]);const u=async()=>{try{await z.deactivateAllProfiles(),d()}catch(e){console.error("Erro ao desativar perfis:",e)}},m=async e=>{try{let a;switch(e){case b:a=await z.createSleepProfile();break;case y:a=await z.createWorkProfile();break;case j:a=await z.createVacationProfile();break;case v:a=await z.createMeetingProfile();break;default:return}d()}catch(a){console.error("Erro ao criar perfil:",a)}},p=e=>{switch(e){case b:return(0,o.jsx)("span",{className:"text-lg",children:"\ud83c\udf19"});case y:return(0,o.jsx)("span",{className:"text-lg",children:"\ud83d\udcbc"});case j:return(0,o.jsx)("span",{className:"text-lg",children:"\ud83c\udfd6\ufe0f"});case v:return(0,o.jsx)("span",{className:"text-lg",children:"\ud83d\udc65"});default:return(0,o.jsx)("span",{className:"text-lg",children:"\ud83d\udcf1"})}};return(0,o.jsxs)("div",{className:"bg-white rounded-paz shadow-paz overflow-hidden transition-all mb-4",children:[(0,o.jsxs)("div",{className:"bg-paz-blue-50 p-4 flex justify-between items-center cursor-pointer border-b border-paz-blue-100",onClick:()=>i(!n),children:[(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("div",{className:"text-paz-blue-600 p-2 rounded-full bg-paz-blue-100 mr-3",children:(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:"font-semibold text-lg text-paz-blue-800",children:"Perfis de Bloqueio"}),(0,o.jsx)("p",{className:"text-sm text-paz-blue-600",children:c?"Ativo: ".concat(c.name):"Nenhum perfil ativo"})]})]}),(0,o.jsx)("div",{className:"text-paz-blue-600",children:(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 transition-transform ".concat(n?"rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),n&&(0,o.jsx)("div",{className:"p-4",children:t?(0,o.jsx)("div",{className:"flex justify-center py-8",children:(0,o.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-paz-blue-600"})}):(0,o.jsxs)("div",{children:[e.length>0?(0,o.jsx)("div",{className:"space-y-3 mb-6",children:e.map((e=>(0,o.jsxs)("div",{className:"p-3 rounded-lg border ".concat(e.status===N?"border-paz-blue-500 bg-paz-blue-50":"border-gray-200 bg-gray-50"),children:[(0,o.jsxs)("div",{className:"flex justify-between items-start",children:[(0,o.jsxs)("div",{className:"flex items-center",children:[p(e.type),(0,o.jsxs)("div",{className:"ml-2",children:[(0,o.jsx)("h4",{className:"font-medium",children:e.name}),(0,o.jsx)("p",{className:"text-sm text-gray-600",children:e.description})]})]}),e.status===N&&(0,o.jsx)("span",{className:"bg-paz-green-100 text-paz-green-800 text-xs px-2 py-1 rounded-full",children:"Ativo"}),e.status===k&&(0,o.jsx)("span",{className:"bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded-full",children:"Agendado"})]}),(0,o.jsxs)("div",{className:"mt-3 flex justify-end space-x-2",children:[e.status!==N&&(0,o.jsx)("button",{onClick:()=>(async e=>{try{await z.activateProfile(e),d()}catch(a){console.error("Erro ao ativar perfil:",a)}})(e.id),className:"px-3 py-1 bg-paz-blue-600 hover:bg-paz-blue-700 text-white text-sm rounded transition",children:"Ativar"}),e.status===N&&(0,o.jsx)("button",{onClick:u,className:"px-3 py-1 bg-paz-red-600 hover:bg-paz-red-700 text-white text-sm rounded transition",children:"Desativar"})]})]},e.id)))}):(0,o.jsx)("div",{className:"text-center py-6 mb-6",children:(0,o.jsx)("p",{className:"text-gray-600",children:"Nenhum perfil de bloqueio configurado. Crie um perfil para come\xe7ar."})}),(0,o.jsxs)("div",{className:"mt-6 border-t border-gray-200 pt-4",children:[(0,o.jsx)("h4",{className:"font-medium text-paz-blue-800 mb-3",children:"Adicionar Perfil"}),(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,o.jsxs)("button",{onClick:()=>m(b),className:"flex items-center justify-center p-3 bg-indigo-50 hover:bg-indigo-100 text-indigo-800 rounded transition",children:[(0,o.jsx)("span",{className:"mr-2",children:"\ud83c\udf19"}),(0,o.jsx)("span",{children:"Modo Sono"})]}),(0,o.jsxs)("button",{onClick:()=>m(y),className:"flex items-center justify-center p-3 bg-green-50 hover:bg-green-100 text-green-800 rounded transition",children:[(0,o.jsx)("span",{className:"mr-2",children:"\ud83d\udcbc"}),(0,o.jsx)("span",{children:"Modo Trabalho"})]}),(0,o.jsxs)("button",{onClick:()=>m(j),className:"flex items-center justify-center p-3 bg-red-50 hover:bg-red-100 text-red-800 rounded transition",children:[(0,o.jsx)("span",{className:"mr-2",children:"\ud83c\udfd6\ufe0f"}),(0,o.jsx)("span",{children:"Modo F\xe9rias"})]}),(0,o.jsxs)("button",{onClick:()=>m(v),className:"flex items-center justify-center p-3 bg-amber-50 hover:bg-amber-100 text-amber-800 rounded transition",children:[(0,o.jsx)("span",{className:"mr-2",children:"\ud83d\udc65"}),(0,o.jsx)("span",{children:"Modo Reuni\xe3o"})]})]})]})]})})]})};let C=null,S=0;const P=432e5,R={async initialize(){try{const e=await r.A.getItem("shared_blacklist");e&&(C=e.data,S=e.timestamp)}catch(e){console.error("Erro ao carregar blacklist compartilhada:",e)}},async checkNumber(e){if(await this.ensureUpdated(),!C)return{isBlocked:!1};const a=C.find((a=>a.phoneNumber===e||a.phoneNumber===e.replace(/\D/g,"")));if(a)return{isBlocked:!0,reason:a.reason||"N\xfamero reportado pela comunidade",reportCount:a.reportCount||1,category:a.category||"desconhecido",confidence:a.confidence||"medium"};const t=e.replace(/\D/g,""),s=C.find((e=>"prefix"===e.type&&t.startsWith(e.prefix)));return s?{isBlocked:!0,reason:s.reason||"Prefixo reportado pela comunidade",reportCount:s.reportCount||1,category:s.category||"desconhecido",confidence:"low"}:{isBlocked:!1}},async syncWithServer(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const a=Date.now();if(!e&&C&&a-S<P)return!0;try{await new Promise((e=>setTimeout(e,600)));const e=[{phoneNumber:"551145678901",reason:"Telemarketing agressivo",reportCount:42,category:"telemarketing",confidence:"high",firstReported:"2023-01-15"},{phoneNumber:"11983745620",reason:"Golpe financeiro",reportCount:27,category:"scam",confidence:"high",firstReported:"2023-03-22"},{type:"prefix",prefix:"11994",reason:"Operadora associada a spam",reportCount:89,category:"spam",confidence:"medium",firstReported:"2023-02-10"}];return C=e,S=a,await r.A.setItem("shared_blacklist",{data:e,timestamp:a,version:"1.0"}),console.log("Blacklist compartilhada atualizada com sucesso"),!0}catch(t){return console.error("Erro ao sincronizar blacklist compartilhada:",t),!1}},async ensureUpdated(){(!C||Date.now()-S>P)&&await this.syncWithServer()},async reportNumber(e,a,t){try{if(console.log("N\xfamero ".concat(e," reportado como ").concat(t,": ").concat(a)),await new Promise((e=>setTimeout(e,500))),C){const s=C.find((a=>a.phoneNumber===e));s?(s.reportCount=(s.reportCount||1)+1,s.reason=a||s.reason,s.category=t||s.category):C.push({phoneNumber:e,reason:a,category:t,reportCount:1,confidence:"low",firstReported:(new Date).toISOString().split("T")[0]}),await r.A.setItem("shared_blacklist",{data:C,timestamp:S,version:"1.0"})}return!0}catch(s){return console.error("Erro ao reportar n\xfamero:",s),!1}},async getStats(){if(await this.ensureUpdated(),!C)return{total:0};const e={};let a=0;return C.forEach((t=>{const s=t.category||"unknown";e[s]=(e[s]||0)+1,a+=t.reportCount||1})),{total:C.length,lastUpdated:new Date(S).toISOString(),totalReportCount:a,categories:e,prefixRules:C.filter((e=>"prefix"===e.type)).length}}},D=()=>{const[e,a]=(0,s.useState)(!0),[t,r]=(0,s.useState)(null),[n,i]=(0,s.useState)(!1),[l,d]=(0,s.useState)(""),[u,m]=(0,s.useState)(null),[p,h]=(0,s.useState)({phoneNumber:"",reason:"",category:"spam"}),[x,g]=(0,s.useState)(!1),[f,b]=(0,s.useState)(!1);(0,s.useEffect)((()=>{(async()=>{await R.initialize(),y()})()}),[]);const y=(0,s.useCallback)((async()=>{a(!0);try{const e=await R.getStats();r(e)}catch(e){console.error("Erro ao carregar estat\xedsticas:",e)}finally{a(!1)}}),[]);return(0,o.jsxs)("div",{className:"bg-white rounded-paz shadow-paz overflow-hidden transition-all mb-4",children:[(0,o.jsxs)("div",{className:"bg-paz-blue-50 p-4 flex justify-between items-center cursor-pointer border-b border-paz-blue-100",onClick:()=>i(!n),children:[(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("div",{className:"text-paz-blue-600 p-2 rounded-full bg-paz-blue-100 mr-3",children:(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:"font-semibold text-lg text-paz-blue-800",children:"Blacklist Comunit\xe1ria"}),(0,o.jsx)("p",{className:"text-sm text-paz-blue-600",children:t?"".concat(t.total," n\xfameros bloqueados"):"Carregando..."})]})]}),(0,o.jsx)("div",{className:"text-paz-blue-600",children:(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 transition-transform ".concat(n?"rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),n&&(0,o.jsx)("div",{className:"p-4",children:e&&!t?(0,o.jsx)("div",{className:"flex justify-center py-8",children:(0,o.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-paz-blue-600"})}):(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg mb-4",children:[(0,o.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Resumo da Blacklist"}),(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,o.jsxs)("div",{className:"bg-white p-3 rounded shadow-sm",children:[(0,o.jsx)("div",{className:"text-sm text-gray-500",children:"N\xfameros Bloqueados"}),(0,o.jsx)("div",{className:"text-xl font-semibold text-paz-blue-700",children:(null===t||void 0===t?void 0:t.total)||0})]}),(0,o.jsxs)("div",{className:"bg-white p-3 rounded shadow-sm",children:[(0,o.jsx)("div",{className:"text-sm text-gray-500",children:"Total de Den\xfancias"}),(0,o.jsx)("div",{className:"text-xl font-semibold text-paz-red-700",children:(null===t||void 0===t?void 0:t.totalReportCount)||0})]})]}),(0,o.jsxs)("div",{className:"mt-3 text-xs text-gray-500 text-right",children:["\xdaltima atualiza\xe7\xe3o: ",null!==t&&void 0!==t&&t.lastUpdated?new Date(t.lastUpdated).toLocaleString():"Desconhecida"]})]}),(0,o.jsxs)("div",{className:"mb-6",children:[(0,o.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Verificar N\xfamero"}),(0,o.jsxs)("div",{className:"flex space-x-2",children:[(0,o.jsx)("input",{type:"text",className:"flex-1 px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-paz-blue-500",placeholder:"Digite um n\xfamero para verificar",value:l,onChange:e=>d(e.target.value)}),(0,o.jsx)("button",{onClick:async()=>{if(!l||l.length<4)m({error:"Digite ao menos 4 d\xedgitos do n\xfamero"});else{a(!0);try{const e=await R.checkNumber(l);m(e)}catch(e){console.error("Erro ao verificar n\xfamero:",e),m({error:"Erro ao verificar n\xfamero"})}finally{a(!1)}}},disabled:e,className:"px-4 py-2 bg-paz-blue-600 hover:bg-paz-blue-700 text-white rounded disabled:opacity-50",children:e?"Verificando...":"Verificar"})]}),u&&(0,o.jsx)("div",{className:"mt-3 p-3 rounded ".concat(u.error||u.isBlocked?"bg-paz-red-50 text-paz-red-800":"bg-paz-green-50 text-paz-green-800"),children:u.error?(0,o.jsx)("p",{children:u.error}):u.isBlocked?(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:"font-medium",children:"N\xfamero bloqueado na blacklist comunit\xe1ria"}),(0,o.jsx)("p",{className:"text-sm",children:u.reason}),(0,o.jsxs)("div",{className:"mt-1 flex space-x-2 text-xs",children:[(0,o.jsxs)("span",{className:"bg-paz-red-200 px-2 py-1 rounded",children:[u.reportCount," den\xfancias"]}),(0,o.jsxs)("span",{className:"bg-paz-red-200 px-2 py-1 rounded",children:["Categoria: ",u.category]})]})]}):(0,o.jsx)("p",{children:"N\xfamero n\xe3o encontrado na blacklist comunit\xe1ria"})})]}),(0,o.jsx)("div",{children:f?(0,o.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,o.jsx)("h4",{className:"font-medium text-gray-700 mb-3",children:"Denunciar N\xfamero"}),(0,o.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),p.phoneNumber&&p.reason){g(!0);try{await R.reportNumber(p.phoneNumber,p.reason,p.category),h({phoneNumber:"",reason:"",category:"spam"}),b(!1),y(),alert("N\xfamero reportado com sucesso!")}catch(a){console.error("Erro ao reportar n\xfamero:",a),alert("Erro ao reportar n\xfamero")}finally{g(!1)}}else alert("Preencha todos os campos obrigat\xf3rios")},children:[(0,o.jsxs)("div",{className:"mb-3",children:[(0,o.jsx)("label",{className:"block text-gray-700 text-sm font-medium mb-1",children:"N\xfamero de Telefone*"}),(0,o.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-paz-blue-500",placeholder:"Ex: 11987654321",value:p.phoneNumber,onChange:e=>h((0,c.A)((0,c.A)({},p),{},{phoneNumber:e.target.value})),required:!0})]}),(0,o.jsxs)("div",{className:"mb-3",children:[(0,o.jsx)("label",{className:"block text-gray-700 text-sm font-medium mb-1",children:"Motivo da Den\xfancia*"}),(0,o.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-paz-blue-500",placeholder:"Ex: Telemarketing insistente",value:p.reason,onChange:e=>h((0,c.A)((0,c.A)({},p),{},{reason:e.target.value})),required:!0})]}),(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsx)("label",{className:"block text-gray-700 text-sm font-medium mb-1",children:"Categoria"}),(0,o.jsxs)("select",{className:"w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-paz-blue-500",value:p.category,onChange:e=>h((0,c.A)((0,c.A)({},p),{},{category:e.target.value})),children:[(0,o.jsx)("option",{value:"spam",children:"Spam/Publicidade"}),(0,o.jsx)("option",{value:"telemarketing",children:"Telemarketing"}),(0,o.jsx)("option",{value:"scam",children:"Golpe/Fraude"}),(0,o.jsx)("option",{value:"robocall",children:"Liga\xe7\xe3o Autom\xe1tica"}),(0,o.jsx)("option",{value:"harassment",children:"Ass\xe9dio"}),(0,o.jsx)("option",{value:"other",children:"Outro"})]})]}),(0,o.jsxs)("div",{className:"flex space-x-2 justify-end",children:[(0,o.jsx)("button",{type:"button",onClick:()=>b(!1),className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 rounded",children:"Cancelar"}),(0,o.jsx)("button",{type:"submit",disabled:x,className:"px-4 py-2 bg-paz-red-600 hover:bg-paz-red-700 text-white rounded disabled:opacity-50",children:x?"Enviando...":"Denunciar"})]})]})]}):(0,o.jsx)("button",{onClick:()=>b(!0),className:"w-full py-2 px-4 bg-paz-red-600 hover:bg-paz-red-700 text-white rounded",children:"Denunciar um n\xfamero"})})]})})]})},I=()=>{const[e,a]=(0,s.useState)(!1);(0,s.useEffect)((()=>{(async()=>{try{await Promise.all([R.initialize()]),a(!0)}catch(e){console.error("Erro ao inicializar servi\xe7os de prote\xe7\xe3o avan\xe7ada:",e)}})()}),[]);return(0,o.jsxs)("div",{className:"max-w-3xl mx-auto space-y-6 p-4",children:[(0,o.jsxs)("div",{className:"bg-white rounded-paz shadow-paz p-6",children:[(0,o.jsx)("h2",{className:"text-2xl font-bold text-paz-blue-800 mb-2",children:"Prote\xe7\xe3o Avan\xe7ada"}),(0,o.jsx)("p",{className:"text-gray-600 mb-6",children:"Ferramentas inteligentes para maximizar sua prote\xe7\xe3o contra chamadas indesejadas."}),e?(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsx)(i,{onApplyRecommendation:async e=>{try{let a;switch(e.action){case"block_number":console.log("Bloqueando n\xfamero: ".concat(e.value));break;case"block_time":const t=parseInt(e.value.split(":")[0],10);a=await g.createTimeRule(t,(t+4)%24,[0,1,2,3,4,5,6],"Bloqueio hor\xe1rio ".concat(e.value)),console.log("Regra de hor\xe1rio criada: ".concat(a.id));break;case"block_prefix":console.log("Bloqueando prefixo: ".concat(e.value));break;default:console.log("Tipo de recomenda\xe7\xe3o n\xe3o reconhecido")}alert("Recomenda\xe7\xe3o aplicada com sucesso!")}catch(a){console.error("Erro ao aplicar recomenda\xe7\xe3o:",a),alert("N\xe3o foi poss\xedvel aplicar a recomenda\xe7\xe3o.")}}}),(0,o.jsx)(A,{}),(0,o.jsx)(f,{}),(0,o.jsx)(D,{})]}):(0,o.jsxs)("div",{className:"flex flex-col items-center justify-center py-10",children:[(0,o.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-paz-blue-600 mb-4"}),(0,o.jsx)("p",{className:"text-gray-600",children:"Inicializando recursos avan\xe7ados..."})]})]}),(0,o.jsxs)("div",{className:"bg-white rounded-paz shadow-paz p-6",children:[(0,o.jsx)("h3",{className:"font-semibold text-lg text-paz-blue-800 mb-3",children:"Dicas de Prote\xe7\xe3o"}),(0,o.jsxs)("ul",{className:"space-y-2 text-gray-700",children:[(0,o.jsxs)("li",{className:"flex items-start",children:[(0,o.jsx)("span",{className:"text-paz-blue-600 mr-2",children:"\u2713"}),(0,o.jsx)("span",{children:"Utilize perfis de bloqueio para diferentes situa\xe7\xf5es do dia a dia"})]}),(0,o.jsxs)("li",{className:"flex items-start",children:[(0,o.jsx)("span",{className:"text-paz-blue-600 mr-2",children:"\u2713"}),(0,o.jsx)("span",{children:"Configure regras de hor\xe1rio para per\xedodos de descanso e trabalho"})]}),(0,o.jsxs)("li",{className:"flex items-start",children:[(0,o.jsx)("span",{className:"text-paz-blue-600 mr-2",children:"\u2713"}),(0,o.jsx)("span",{children:"Adicione seus contatos importantes \xe0 lista branca para nunca perder chamadas importantes"})]}),(0,o.jsxs)("li",{className:"flex items-start",children:[(0,o.jsx)("span",{className:"text-paz-blue-600 mr-2",children:"\u2713"}),(0,o.jsx)("span",{children:"Reporte n\xfameros indesejados para contribuir com a comunidade"})]})]})]})]})}}}]);
//# sourceMappingURL=186.ead0c386.chunk.js.map